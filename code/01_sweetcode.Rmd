---
title: "project"
author: 'Jessea James: Salem College'
date: "2024-06-24"
output: pdf_document
---

---
Project_Title: "SWEET" - "Support groups Wellness education Eating habits Exercise routines Testing blood sugar"

Research_Question: "What role do health indicators and population factors, play in determining the prevalence of diabetes?"

Content: "Diabetes is a common chronic disease in the United States, affecting millions of people each year and causing a significant financial burden on the economy. It impairs glucose regulation, resulting in a lower quality of life and life expectancy. Diabetes can lead to complications such as heart disease, vision loss, lower limb amputation, and kidney disease. Strategies such as weight loss, healthy eating, and medical treatment can help to mitigate its effects. As of 2018, 34.2 million Americans had diabetes, while 88 million had prediabetes. Ins summary, Diabetes very prevalent in the United States and the wider world, and its incidence varies according to age, education, income, location, and other social determinants."

Context: "The Behavioral Risk Factor Surveillance System (BRFSS) is an annual health-related telephone survey conducted by the CDC. Every year, over 400,000 Americans participate in the survey, which asks about health-related risk behaviors, chronic health conditions, and the use of preventive services. It has been held annually since 1984. For this project, a csv of the dataset available on Kaggle in 2015 was used. This original dataset contains 441,455 responses and 330 features. These features are either questions directly posed to participants or calculated variables based on individual participant responses."

Abstract: "Diabetes and prediabetes constitute significant public health challenges globally, impacting millions of individuals and posing substantial economic burdens. This project will explore the prevalence, risk factors, and implications of these conditions using data from the Behavioral Risk Factor Surveillance System (BRFSS), a comprehensive survey conducted annually by the CDC. Analyzing this dataset will investigate the socioeconomic, and health factors associated with non - diabetic and prediabetes patients in the United States. Findings underscore the critical roles of age, education, income, and ghealth factors in shaping prevalence rates and highlight the importance of lifestyle interventions and healthcare strategies in mitigating these conditions' impact on individuals and society. "
---

#Set Working Directory

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load packages
```{r}
# Load packages (package for cleaning process...)
pacman::p_load(rio, here, janitor, lubridate, matchmaker, epikit, tidyverse)

# here i_am to point at where the whole folder sits
here::i_am("code/01_sweetcode.Rmd")

```

#Data Table
```{r}
# Using read_csv from readr (tidyverse)
# I also use the here command because it helps me to locate the file in the folder using relative paths, and now you and I can both run the script without having to change directories
library(readr)
data <- read_csv(here("data/raw_data/diabetes_binary_health_indicators_BRFSS2015.csv"))

head(data)
```

#Cleaning Dataset
```{r}
# Clean the dataset
data <- data %>%
  clean_names() %>%
  mutate_all(tolower) %>%
  mutate_all(str_remove_all, " ")
```

#Label Categories for Variables

-   Representing Age Range for Age Variable

```{r}
data$age[data$age == 1] <- "18 - 24"
data$age[data$age == 2] <- "25 - 29"
data$age[data$age == 3] <- "30 - 34"
data$age[data$age == 4] <- "35 - 39"
data$age[data$age == 5] <- "40 - 44"
data$age[data$age == 6] <- "45 - 49"
data$age[data$age == 7] <- "50 - 54"
data$age[data$age == 8] <- "55 - 59"
data$age[data$age == 9] <- "60 - 64"
data$age[data$age == 10] <- "65 - 69"
data$age[data$age == 11] <- "70 - 74"
data$age[data$age == 12] <- "75 - 79"
data$age[data$age == 13] <- "80 - 99"
table(data$age)
```

-   Representing Income Range for Income Variable

```{r}
data$income <- factor(data$income, 
                      levels = 1:8, 
                      labels = c("Less than $10,000", "$10,000 to less than $15,000", "$15,000 to less than $20,000", "$20,000 to less than $25,000", "$25,000 to less than $35,000", "$35,000 to less than $50,000", "$50,000 to less than $75,000", "$75,000 or more"))
table(data$income)
```

-   Representing Education Variables with Education Level

```{r}
data$education <- factor(data$education, 
                         levels = 1:7, 
                         labels = c("Never attended school or only kindergarten", 
                                    "Grades 1 through 8 (Elementary)", 
                                    "Grades 9 through 11 (Some high school)", 
                                    "Grade 12 or GED (High school graduate)", 
                                    "College 1 year to 3 years (Some college or technical school)", 
                                    "College 4 years or more (College graduate)", 
                                    "Refused"))
table(data$education)
```

-   Represting General Health Variables

```{r}
data$gen_hlth[data$gen_hlth == 1] <- "Excellent"
data$gen_hlth[data$gen_hlth == 2] <- "Excellent"
data$gen_hlth[data$gen_hlth == 3] <- "Very good"
data$gen_hlth[data$gen_hlth == 4] <- "Good"
data$gen_hlth[data$gen_hlth == 5] <- "Fair"
data$gen_hlth[data$gen_hlth == 6] <- "Poor"
data$gen_hlth[data$gen_hlth == 7] <- "Don’t know/Not Sure"
data$gen_hlth[data$gen_hlth == 8] <- "Refused"

data$gen_hlth <- factor(data$gen_hlth, 
                        levels = c("Excellent", "Very good", "Good", "Fair", "Poor", "Don’t know/Not Sure", "Refused"), 
                        ordered = TRUE)

table(data$gen_hlth)
```

-   Remove Columns PhysHlth, MentHlth

```{r}
data <- data%>%
  select(-c(phys_hlth,ment_hlth))
head(data)
```

-   Representing Diabetes Variable

```{r}
data$diabetes_binary <- factor(data$diabetes_binary, 
                               levels = c(0, 1, 2), 
                               labels = c("No diabetes", "Prediabetes", "Diabetes"))
table(data$diabetes_binary)
```

-   Represting High Blood Pressure Variable

```{r}
data$high_bp <- factor(data$high_bp, levels = c(0, 1), labels = c("No high BP", "High BP"))
table(data$diabetes_binary)
```

-   Represting High Cholesterol Variable

```{r}
data$high_chol <- factor(data$high_chol, levels = c(0, 1), labels = c("No high cholesterol", "High cholesterol"))
table(data$high_chol)
```

-   Representing Values for High Cholesterol

```{r}
data$chol_check <- factor(data$chol_check, levels = c(0, 1), labels = c("No cholesterol check in 5 years", "Cholesterol check in 5 years"))
table(data$chol_check)
```

#Representing Survey Question Variables

Variable Name: smoker Question: Have you smoked at least 100 cigarettes in your entire life? [Note: 5 packs = 100 cigarettes] Response: 0 = no 1 = yes

```{r}
data$smoker <- factor(data$smoker, levels = c(0, 1), labels = c("No", "Yes"))
table(data$smoker)
```

Variable Name: stroke Question: Have you ever had a stroke? Response: 0 = no 1 = yes

```{r}
data$stroke <- factor(data$stroke, levels = c(0, 1), labels = c("No", "Yes"))
table(data$stroke)
```

Variable Name: heartdiseaseorattack Question: Have you ever had a coronary heart disease (CHD) or myocardial infarction (MI)? Response: 0 = no 1 = yes

```{r}
data$heart_diseaseor_attack <- factor(data$heart_diseaseor_attack, levels = c(0, 1), labels = c("No", "Yes"))
table(data$heart_diseaseor_attack)
```

Variable Name: phys_activity Question: Have you done physical activity in past 30 days - not including job? Response: 0 = no 1 = yes

```{r}
data$phys_activity <- factor(data$phys_activity, levels = c(0, 1), labels = c("No", "Yes"))
table(data$phys_activity)
```

Variable Name: fruits Question: Have you consumed Fruit 1 or more times per day? Response: 0 = no 1 = yes

```{r}
data$fruits <- factor(data$fruits, levels = c(0, 1), labels = c("No", "Yes"))
table(data$fruits)
```

Variable Name: veggies Question: Have you consumed Vegetables 1 or more times per day? Response: 0 = no 1 = yes

```{r}
data$veggies <- factor(data$veggies, levels = c(0, 1), labels = c("No", "Yes"))
table(data$veggies)
```

Variable Name: hvy_alcohol_consump Question: Have you consumed heavy drinks (adult men having more than 14 drinks per week and adult women having more than 7 drinks per week)? Response: 0 = no 1 = yes

```{r}
data$hvy_alcohol_consump <- factor(data$hvy_alcohol_consump, levels = c(0, 1), labels = c("No", "Yes"))
table(data$hvy_alcohol_consump)
```

Variable Name: any_healthcare Question:Have any kind of health care coverage, including health insurance, prepaid plans such as HMO, etc.? Response: 0 = no 1 = yes

```{r}
data$any_healthcare <- factor(data$any_healthcare, levels = c(0, 1), labels = c("No", "Yes"))
table(data$any_healthcare)
```

Variable Name: no_docbc_cost Question:Was there a time in the past 12 months when you needed to see a doctor but could not because of cost? Response: 0 = no 1 = yes

```{r}
data$no_docbc_cost <- factor(data$no_docbc_cost, levels = c(0, 1), labels = c("No", "Yes"))
table(data$no_docbc_cost)
```

Variable Name: diff_walk Question:Do you have serious difficulty walking or climbing stairs? Response: 0 = no 1 = yes

```{r}
data$diff_walk <- factor(data$diff_walk, levels = c(0, 1), labels = c("No", "Yes"))
table(data$diff_walk)
```

Variable Name: phys_activity Question:Are you Male or Female? Response: 0 = Female 1 = Male

```{r}
data$sex <- factor(data$sex, levels = c(0, 1), labels = c("Female", "Male"))
table(data$sex)
```

#Save file

```{r}
## I saved it as an RDS file so it retains all the formatting when you load it in the next time
saveRDS(data, here("data/cleaned_data/cleaned_data_basic.RDS"))
```

#Verification of Missing Variables

```{r}
# Check for missing values
# Option 1: Check summary of missing values
summary(is.na(data))

# Option 2: Count missing values per column
colSums(is.na(data))

# Handle missing values: Example strategies

# 1. Impute missing values (replace with mean or median)
# Example: Impute numeric columns with median
data_imputed <- data %>%
  mutate_if(is.numeric, ~if_else(is.na(.), median(., na.rm = TRUE), .))

# 2. Remove rows with any missing values
data_complete <- na.omit(data) 
#### Note: You have atleast one NA in every row so it is removing everything here

# 3. Remove columns with more than a certain threshold of missing values (e.g., 50%)
data_filtered <- data %>%
  select(which(colMeans(!is.na(.)) > 0.5))

# Save all datasets
saveRDS(data_complete, here("data/cleaned_data/cleaned_data_complete.RDS"))
saveRDS(data_imputed, here("data/cleaned_data/cleaned_data_imputed.RDS"))
saveRDS(data_filtered, here("data/cleaned_data/cleaned_data_filtered.RDS"))

```